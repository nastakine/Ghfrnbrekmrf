!function(){$.fn.glDatePicker=function(e){var t="glDatePicker",l=this.data(t);return l?!0===e?l:this:this.each(function(){return $(this).data(t,new glDatePicker(this,e))})},$.fn.glDatePicker.defaults={zIndex:1e3,borderSize:1,calendarOffset:{x:0,y:1},showAlways:!1,hideOnClick:!0,allowMonthSelect:!0,allowYearSelect:!0,todayDate:new Date,selectedDate:null,prevArrow:"◄",nextArrow:"►",selectableDates:null,selectableDateRange:null,specialDates:null,selectableMonths:null,selectableYears:null,selectableDOW:null,monthNames:["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],dowNames:["Вс","Пн","Вт","Ср","Чт","Пт","Сб"],dowOffset:1,onClick:function(e,t,l,a){e.val(e.data("glDatePicker").formatDate(l))},onHover:function(e,t,l,a){},onShow:function(e){e[0].style.display=""},onHide:function(e){e[0].style.display="none"},firstDate:null,customWidth:null};var glDatePicker=function(){function glDatePicker(e,t){var l=this,a=(l.el=$(e),l.el),e=(l.options=$.extend(!0,{},$.fn.glDatePicker.defaults,t),l.options);l.calendar=$($.find("[gldp-el="+a.attr("gldp-id")+" ]")),e.selectedDate=e.selectedDate||e.todayDate,e.firstDate=new Date(e.firstDate||e.selectedDate)._first(),(a.attr("gldp-id")||"").length||a.attr("gldp-id","gldp-"+Math.round(1e10*Math.random())),a[0].classList.add("gldp-el"),l.options.useClick?a.bind("click",function(e){l.show(e)}):a.bind("focus",function(e){l.show(e)}),l.calendar.length&&!e.showAlways&&(l.calendar[0].style.display="none"),$(document).bind("mouseup",function(e){var e=e.target,t=l.calendar;a.is(e)||t.is(e)||0!==t.has(e).length||!t[0].isVisible()||l.hide()}),l.render()}return glDatePicker.prototype={show:function(){var e;$.each($(".gldp-el").not(this.el),function(e,t){t.length&&t.options.onHide(t.calendar)}),this.options.onShow(this.calendar),this.options.overlay&&((e=document.createElement("div")).classList.addMany(["overlay","j-custom-overlay"]),e.style.zIndex=300,this.calendar.overlay=e,document.body.insertBefore(this.calendar.overlay,document.body.firstChild))},hide:function(){var e;this.options&&!this.options.showAlways&&(this.options.onHide(this.calendar),null!=(e=this.calendar.overlay))&&e.remove()},render:function(renderCalback){var self=this,el=self.el,options=self.options,calendar=self.calendar,coreClass=" core border ",todayVal=options.todayDate._val(),todayTime=todayVal.time,maxRow=6,maxCol=7,borderSize=options.borderSize+"px",getSelectableList=function(e,t,l){for(var a,s=[],o=e;o<=t;o++)s.push(o);return l&&(a=[],$.each(l,function(e,t){a._indexOf(t)<0&&a.push(t)}),s=a.length?a:s),s.sort(),s},selectableMonths=getSelectableList(0,11,options.selectableMonths),selectableYears=getSelectableList(todayVal.year-5,todayVal.year+5,options.selectableYears),selectableDOW=getSelectableList(0,6,options.selectableDOW),dowNames=options.dowNames,monthNames=options.monthNames,containerWidth=null!=options.customWidth?options.customWidth:el[0].offsetWidth,containerHeight=containerWidth,getCellSize=function(e,t){return e/t+options.borderSize/t*(t-1)},cellWidth=getCellSize(containerWidth,maxCol),cellHeight=getCellSize(containerHeight,maxRow+2),onResize=(calendar.length?eval(calendar.data("is"))||(containerWidth=calendar[0].offsetWidth,containerHeight=calendar[0].offsetHeight,cellWidth=getCellSize(containerWidth,maxCol),cellHeight=getCellSize(containerHeight,maxRow+2)):(self.calendar=calendar=$("<div/>").attr("gldp-el",el.attr("gldp-id")).data("is",!0),self.calendar[0].style.zIndex=options.zIndex,self.calendar[0].style.display=options.showAlways?void 0:"none",self.calendar[0].style.width=cellWidth*maxCol+"px",$(options.appendTo||"body").append(calendar)),el[0].isHidden()&&(calendar[0].style.display="none"),calendar[0].className="gldp",calendar.children().remove(),function(){calendar[0].style.top=el[0].offsetTop+el[0].offsetHeight+options.calendarOffset.y+"px",calendar[0].style.left=el[0].offsetLeft+options.calendarOffset.x+"px"}),cellCSS=($(window).resize(onResize),onResize(),{width:cellWidth+"px",height:cellHeight+"px",lineHeight:cellHeight+"px"}),setFirstDate=function(e){e&&(options.firstDate=e,self.render())},getFirstDate=function(e){var t=new Date(options.firstDate);for(e=e||0;;){if(t.setMonth(t.getMonth()+e),t.setDate(Math.min(1,t._max())),0==e)break;var l=t._val(),a=l.month,l=l.year;if(-1!=selectableMonths._indexOf(a)){if(-1!=selectableYears._indexOf(l))break;if(l<selectableYears[0]||l>selectableYears[selectableYears.length-1])return null}}return t},prevFirstDate=getFirstDate(-1),nextFirstDate=getFirstDate(1),firstDate=options.firstDate=getFirstDate(),firstDateVal=firstDate._val(),firstDateMonth=firstDateVal.month,firstDateYear=firstDateVal.year,startDate=new Date(firstDate),dowOffset=Math.abs(Math.min(6,Math.max(0,options.dowOffset))),startOffset=startDate.getDay()-dowOffset,startOffset=startOffset<1?-7-startOffset:-startOffset,dowNames=dowNames.concat(dowNames).slice(dowOffset,dowOffset+7);startDate._add(startOffset);for(var showPrev=prevFirstDate,showNext=nextFirstDate,monyearClass=coreClass+"monyear ",prevCell=$('<div class="'+monyearClass+'"/>'),prevCellCss=$.extend({},cellCSS,{borderWidth:borderSize+" 0 0 "+borderSize}),prevCellCssKeys=Object.keys(prevCellCss),i=0;i<prevCellCssKeys.length;i++)prevCell[0].style[prevCellCssKeys[i]]=prevCellCss[prevCellCssKeys[i]];prevCell.append($('<a class="prev-arrow'+(showPrev?"":"-off")+'"/>').html(options.prevArrow)).mousedown(function(){return!1}).click(function(e){""!=options.prevArrow&&showPrev&&(e.stopPropagation(),setFirstDate(prevFirstDate))});for(var titleCellCount=maxCol-2,titleWidth=cellWidth*titleCellCount-titleCellCount*options.borderSize+options.borderSize,titleCell=$('<div class="'+monyearClass+'title"/>'),titleCellCss=$.extend({},cellCSS,{width:titleWidth+"px",borderTopWidth:borderSize,marginLeft:"-"+borderSize}),titleCellCssKeys=Object.keys(titleCellCss),i=0;i<titleCellCssKeys.length;i++)titleCell[0].style[titleCellCssKeys[i]]=titleCellCss[titleCellCssKeys[i]];for(var nextCell=$('<div class="'+monyearClass+'"/>'),nextCellCss=$.extend({},cellCSS,{marginLeft:"-"+borderSize,borderWidth:borderSize+" "+borderSize+" 0 0"}),nextCellCssKeys=Object.keys(nextCellCss),i=0;i<nextCellCssKeys.length;i++)nextCell[0].style[nextCellCssKeys[i]]=nextCellCss[nextCellCssKeys[i]];nextCell.append($('<a class="next-arrow'+(showNext?"":"-off")+'"/>').html(options.nextArrow)).mousedown(function(){return!1}).click(function(e){""!=options.nextArrow&&showNext&&(e.stopPropagation(),setFirstDate(nextFirstDate))}),calendar.append(prevCell).append(titleCell).append(nextCell);for(var row=0,cellIndex=0;row<maxRow+1;row++)for(var col=0;col<maxCol;col++,cellIndex++){var cellDate=new Date(startDate),cellClass="day",cellZIndex=options.zIndex+cellIndex,cell=$("<div/>"),cellDateVal,cellDateTime,specialData,isSelectable,getRepeatDate;row?(cellDate._add(col+(row-1)*maxCol),cellDateVal=cellDate._val(),cellDateTime=cellDateVal.time,specialData=null,isSelectable=!0,getRepeatDate=function(e,t){return!0===e.repeatYear&&t.setYear(cellDateVal.year),!0===e.repeatMonth&&t.setMonth(cellDateVal.month),t._val()},cell.html(cellDateVal.date),options.selectableDateRange&&(isSelectable=!1,$.each(options.selectableDateRange,function(e,t){var l=t.from,a=t.to||null||new Date(t.from.getFullYear(),t.from.getMonth(),t.from._max()),l=getRepeatDate(t,l);if(a=getRepeatDate(t,a),cellDateTime>=l.time&&cellDateTime<=a.time)return isSelectable=!0})),options.selectableDates&&((options.selectableDateRange&&!isSelectable||isSelectable&&!options.selectableDateRange)&&(isSelectable=!1),$.each(options.selectableDates,function(e,t){if(getRepeatDate(t,t.date).time==cellDateTime)return isSelectable=!0})),!isSelectable||selectableYears._indexOf(cellDateVal.year)<0||selectableMonths._indexOf(cellDateVal.month)<0||selectableDOW._indexOf(cellDateVal.day)<0?(cellClass="noday",todayTime==cellDateTime&&(cellClass+=" today")):(cellClass=["sun","mon","tue","wed","thu","fri","sat"][cellDateVal.day],firstDateMonth!=cellDateVal.month&&(cellClass+=" outday"),todayTime==cellDateTime&&(cellClass+=" today"),options.selectedDate._time()==cellDateTime&&(cellClass="selected",cellZIndex+=51),options.specialDates&&$.each(options.specialDates,function(e,t){getRepeatDate(t,t.date).time==cellDateTime&&(cellClass=t.cssClass||"special",cellZIndex+=52,specialData=t.data)}),cell.mousedown(function(){return!1}).hover(function(e){e.stopPropagation();e=$(this).data("data");options.onHover(el,cell,e.date,e.data)}).click(function(e){e.stopPropagation();e=$(this).data("data");options.selectedDate=options.firstDate=e.date,self.render(function(){!options.showAlways&&options.hideOnClick&&self.hide()}),options.onClick(el,$(this),e.date,e.data)}))):(cellClass="dow",cell.html(dowNames[col]),cellDate=null),$.extend(cellCSS,{borderTopWidth:borderSize,borderBottomWidth:borderSize,borderLeftWidth:0<row||!row&&!col?borderSize:0,borderRightWidth:0<row||!row&&6==col?borderSize:0,marginLeft:0<col?"-"+borderSize:0,marginTop:0<row?"-"+borderSize:0,zIndex:cellZIndex}),cell.data("data",{date:cellDate,data:specialData}),cell[0].className=coreClass+cellClass,Object.keys(cellCSS).forEach(e=>{cell[0].style[e]=cellCSS[e]}),calendar.append(cell)}var toggleYearMonthSelect=function(e){var t="inline-block",l="none";options.allowMonthSelect&&(monthText[0].style.display=e?t:l,monthSelect[0].style.display=e?l:t),options.allowYearSelect&&(yearText[0].style.display=e?l:t,yearSelect[0].style.display=e?t:l)},onYearMonthSelect=function(){options.firstDate=new Date(yearSelect.val(),monthSelect.val(),1),self.render()},monthSelect=$('<select style="display:none;"/>').change(onYearMonthSelect),yearSelect=$('<select style="display:none;"/>').change(onYearMonthSelect),monthText=$("<span/>").html(monthNames[firstDateMonth]).mousedown(function(){return!1}).click(function(e){e.stopPropagation(),toggleYearMonthSelect(!1)}),yearText=$("<span/>").html(firstDateYear).mousedown(function(){return!1}).click(function(e){e.stopPropagation(),toggleYearMonthSelect(!0)}),titleYearMonth=($.each(monthNames,function(e,t){options.allowMonthSelect&&-1!=selectableMonths._indexOf(e)&&(t=$("<option/>").html(t).attr("value",e),e==firstDateMonth&&t.attr("selected","selected"),monthSelect.append(t))}),$.each(selectableYears,function(e,t){var l;options.allowYearSelect&&(l=$("<option/>").html(t).attr("value",t),t==firstDateYear&&l.attr("selected","selected"),yearSelect.append(l))}),$("<div/>").append(monthText).append(monthSelect).append(yearText).append(yearSelect));titleCell.children().remove(),titleCell.append(titleYearMonth),renderCalback=renderCalback||function(){},renderCalback()},formatDate:function(e){var t;if(""!=e)return t="т"==(t=this.options.monthNames[e.getMonth()]).slice(t.length-1)?t+"a":t.replace(/[ьй]$/g,"я"),e.getDate()+" "+t.toLowerCase()+" "+e.getFullYear()+" г."},renderWithSelect:function(){""!=this.options.selectedDate&&(this.render(),this.el.val(this.formatDate(this.options.selectedDate)))}},glDatePicker}();Date.prototype._clear=function(){return this.setHours(0),this.setMinutes(0),this.setSeconds(0),this.setMilliseconds(0),this},Date.prototype._time=function(){return this._clear().getTime()},Date.prototype._max=function(){return[31,28+(1==new Date(this.getYear(),1,29).getMonth()?1:0),31,30,31,30,31,31,30,31,30,31][this.getMonth()]},Date.prototype._add=function(e){this.setDate(this.getDate()+e)},Date.prototype._first=function(){var e=new Date(this);return e.setDate(1),e},Date.prototype._val=function(){return this._clear(),{year:this.getFullYear(),month:this.getMonth(),date:this.getDate(),time:this.getTime(),day:this.getDay()}},Array.prototype._indexOf=function(e){return $.inArray(e,this)}}();